-- To enable Lua language server support:
-- 1. Install lua-language-server (https://github.com/LuaLS/lua-language-server)
-- 2. Uncomment the lua_ls section below
-- 3. Restart Neovim

local on_attach = require("nvchad.configs.lspconfig").on_attach
local capabilities = require("nvchad.configs.lspconfig").capabilities

-- Update deprecated tsserver to ts_ls
local servers = {
  "html",
  "cssls",
  "ts_ls",         -- Fixed: was "tsserver"
  "jsonls",
  "eslint",
  "bashls",
  -- "lua_ls",     -- Uncomment this line to enable Lua language server
}

-- Configure each language server
for _, server in ipairs(servers) do
  local opts = {
    on_attach = on_attach,
    capabilities = capabilities,
  }

  -- Server-specific configurations
  if server == "ts_ls" then
    opts.root_dir = require("lspconfig").util.root_pattern("package.json", "tsconfig.json", "jsconfig.json", ".git")
    opts.single_file_support = false
  elseif server == "lua_ls" then
    opts.settings = {
      Lua = {
        runtime = { version = "LuaJIT" },
        workspace = {
          checkThirdParty = false,
        },
        telemetry = { enable = false },
      },
    }
  end

  -- Setup the server using lspconfig (still valid for configuration)
  require("lspconfig")[server].setup(opts)
end